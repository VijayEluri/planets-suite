<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jstl/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:t="http://myfaces.apache.org/tomahawk">
<body>
<ui:composition template="/WEB-INF/planets/page-template.xhtml">
    <ui:param name="pagetitle" value="Workflow Parameters Panel"/>
		<rich:panel>
			<f:facet name="header">Edit Parameters for #{theWorkflow.editedSBId}</f:facet>
      		<h:form>
            	<h:dataTable binding="#{theWorkflow.parameterTable}" var="params" value="#{theWorkflow.serviceParametersToEdit}">
		              <f:facet name="header">
		                  <rich:columnGroup>
		                      <rich:column>
		                          <h:outputText value="Name" />
		                      </rich:column>
		                      <rich:column>
		                          <h:outputText value="Value" />
		                      </rich:column>
		                      <rich:column>
		                          <h:outputText value="Change Value" />
		                      </rich:column>
		                      <rich:column>
		                          <h:outputText value="Remove Parameter" />
		                      </rich:column>
		                  </rich:columnGroup>
		              </f:facet>
	                  <rich:column>
	                      <h:outputText value="#{params.name}"></h:outputText>
	                  </rich:column>
	                  <rich:column>
	                      <h:outputText value="#{params.value}"></h:outputText>
	                  </rich:column>
	                  <rich:column>
	                      <h:commandButton action="#{theWorkflow.updateParameter}" value="Update" />
	                  </rich:column>
	                  <rich:column>
	                      <h:commandButton action="#{theWorkflow.removeParameter}" value="Delete" />
	                  </rich:column>
          		</h:dataTable>
          		<rich:panel>
          			<f:facet name="header">
          				<h:outputText value="New Parameter Value" />
          			</f:facet>
          			<h:inputText value="#{theWorkflow.newValue}"/>
          		</rich:panel>
			</h:form>

         <a4j:form>
			<rich:panel>
		       <f:facet name="header">Add Parameter</f:facet>
		       <h:panelGrid columns="2">
			        <h:panelGrid columns="2">
			            <h:outputText value="Name: "/>
			            <h:inputText value="#{theWorkflow.parameterName}" />
			            <h:outputText value="Value:"/>
			            <h:inputText value="#{theWorkflow.parameterValue}" />
			        </h:panelGrid>
					<h:commandButton actionListener="#{theWorkflow.addParameter}" value="Add" />
		    	</h:panelGrid>
     		</rich:panel>
   		</a4j:form>

	 	<h:form>
	    	<h:panelGroup>
	 			<h:commandButton
	 				id="returnToMain"
	 				value="Done"
	 				onclick="window.opener.location.href = window.opener.location.href;window.close();" 
	 				immediate="true"/>
	 		</h:panelGroup>
		</h:form>
	</rich:panel>

    <rich:panel>
        <rich:dataTable var="errors" value="#{theWorkflow.errorMessageString}">
         <f:facet name="header">
             <rich:columnGroup>
                 <rich:column>
                     <h:outputText value="Error Messages" />
                 </rich:column>
             </rich:columnGroup>
         </f:facet>
            <rich:column>
                <h:outputText value="#{errors}"></h:outputText>
            </rich:column>
        </rich:dataTable>
    </rich:panel>
	
</ui:composition>
</body>
</html>