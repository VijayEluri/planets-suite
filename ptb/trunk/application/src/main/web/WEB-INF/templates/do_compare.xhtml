<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core" 
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:t="http://myfaces.apache.org/tomahawk"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">
<body>
  <ui:composition rendered="#{dob != null}">

  <a4j:form id="dobCompareForm">
    <!-- Persist the experiment ID through POST, if any. -->    
    <input type="hidden" name="eid" value="#{ExperimentInspector.experimentId}" />
    <!-- Persist the dob ID through POST, if any. -->    
    <input type="hidden" name="dobUri1" value="#{DobCompare.dobUri1}"/>
    <input type="hidden" name="dobUri2" value="#{DobCompare.dobUri2}"/>
  
        <div id="mainwrapper">
        <div id="maincol">
        <div class="innertubemain">

  
  <div id="digitalObjectRegistryBrowser">
  <h:panelGrid columns="2" columnClasses="halfContent">
    <rich:panel id="dobSummary1">
      <f:facet name="header">
            <h:outputText value="#{DobCompare.dob1.leafname}"/>
      </f:facet>

         <ui:include src="/WEB-INF/templates/do_summary.xhtml">
           <ui:param name="dob" value="#{DobCompare.dob1}"/>
         </ui:include>
    
    
    </rich:panel>
    
    <rich:panel id="dobSummary2">
      <f:facet name="header">
            <h:outputText value="#{DobCompare.dob2.leafname}"/>
      </f:facet>

         <ui:include src="/WEB-INF/templates/do_summary.xhtml">
           <ui:param name="dob" value="#{DobCompare.dob2}"/>
         </ui:include>
  
    
    </rich:panel>
    
    </h:panelGrid>
    
    <rich:panel id="dobCompareDirect">
      <f:facet name="header">
            <h:outputText value="Compare #{DobCompare.dob1.leafname} against #{DobCompare.dob2.leafname} directly"/>
      </f:facet>
      
      <dt><b>Compare</b></dt>
      <dd>
        <h:selectOneMenu value="#{DobCompare.compareService}">
          <f:selectItem itemValue="" itemLabel="[none]" />
          <f:selectItems value="#{DobCompare.compareServiceList}" />
          <a4j:support event="onchange" reRender="dobCompareForm" />
        </h:selectOneMenu>
      </dd>
      <dt>Compare Report:</dt>
      <dd>
        <h:outputText value="#{DobCompare.compareServiceReport}"/>
      </dd>
      <dt>Compare Result:</dt>
          <dd>
            <a4j:repeat value="#{DobCompare.compareProperties}" var="prop">
             <a4j:commandLink>
               <h:outputText value=" #{prop.name}"/>
               <rich:toolTip value="#{prop.uri}"/>
             </a4j:commandLink>
             <h:outputText value=" = "/>
             <i><h:outputText value="#{prop.value}"/></i><br/>
            </a4j:repeat>
          </dd>
      <dd>
         <ui:include src="/WEB-INF/templates/fragments/show_error_modal.xhtml">
           <ui:param name="message" value="#{DobCompare.compareServiceException}"/>
           <ui:param name="exception" value="#{DobCompare.compareServiceStackTrace}"/>
           <ui:param name="uid" value="1"/>
         </ui:include>
      </dd>
      
          
    </rich:panel>
    
    <rich:panel id="dobCompare">
      <f:facet name="header">
            <h:outputText value="Compare #{DobCompare.dob1.leafname} against #{DobCompare.dob2.leafname} via Characterisation"/>
      </f:facet>
    
      <dt><b>Characterise</b></dt>
      <dd>
        <h:selectOneMenu value="#{DobCompare.characteriseService}">
          <f:selectItem itemValue="" itemLabel="[none]" />
          <f:selectItems value="#{DobCompare.characteriseServiceList}" />
          <a4j:support event="onchange" reRender="dobCompareForm" />
        </h:selectOneMenu>
      </dd>

  <h:panelGrid columns="2" columnClasses="halfContent">
    <rich:panel id="dobProperties1">
      <f:facet name="header">
            <h:outputText value="#{DobCompare.dob1.leafname}"/>
      </f:facet>

      <dt>Characterise Report:</dt>
      <dd>
        <h:outputText value="#{DobCompare.characterise1ServiceReport}"/>
      </dd>
      <dt>Characterise Result:</dt>
          <dd>
            <a4j:repeat value="#{DobCompare.characterise1Properties}" var="prop">
             <a4j:commandLink>
               <h:outputText value=" #{prop.name}"/>
               <rich:toolTip value="#{prop.uri}"/>
             </a4j:commandLink>
             <h:outputText value=" = "/>
             <i><h:outputText value="#{prop.value}"/></i><br/>
            </a4j:repeat>
          </dd>
      <dd>
         <ui:include src="/WEB-INF/templates/fragments/show_error_modal.xhtml">
           <ui:param name="message" value="#{DobCompare.characteriseServiceException}"/>
           <ui:param name="exception" value="#{DobCompare.characteriseServiceStackTrace}"/>
           <ui:param name="uid" value="2"/>
         </ui:include>
      </dd>
    
    
    </rich:panel>
    
    <rich:panel id="dobProperties2">
      <f:facet name="header">
            <h:outputText value="#{DobCompare.dob2.leafname}"/>
      </f:facet>

      <dt>Characterise Report:</dt>
      <dd>
        <h:outputText value="#{DobCompare.characterise2ServiceReport}"/>
      </dd>
      <dt>Characterise Result:</dt>
          <dd>
            <a4j:repeat value="#{DobCompare.characterise2Properties}" var="prop">
             <a4j:commandLink>
               <h:outputText value=" #{prop.name}"/>
               <rich:toolTip value="#{prop.uri}"/>
             </a4j:commandLink>
             <h:outputText value=" = "/>
             <i><h:outputText value="#{prop.value}"/></i><br/>
            </a4j:repeat>
          </dd>
  
    
    </rich:panel>
  </h:panelGrid>

      <p>
      <br/>
      </p> 
      
      <dt><b>Compare Properties</b></dt>
      <dd>
        <h:selectOneMenu value="#{DobCompare.compareExtractedService}">
          <f:selectItem itemValue="" itemLabel="[none]" />
          <f:selectItems value="#{DobCompare.comparePropertiesServiceList}" />
          <a4j:support event="onchange" reRender="dobCompareForm" />
        </h:selectOneMenu>
      </dd>
      
      <dt>Compare Properties Report:</dt>
      <dd>
        <h:outputText value="#{DobCompare.compareExtractedServiceReport}"/>
      </dd>
      <dt>Compare Properties Result:</dt>
          <dd>
            <a4j:repeat value="#{DobCompare.compareExtractedProperties}" var="prop">
             <a4j:commandLink>
               <h:outputText value=" #{prop.name}"/>
               <rich:toolTip value="#{prop.uri}"/>
             </a4j:commandLink>
             <h:outputText value=" = "/>
             <i><h:outputText value="#{prop.value}"/></i><br/>
            </a4j:repeat>
          </dd>
          
      <dd>
         <ui:include src="/WEB-INF/templates/fragments/show_error_modal.xhtml">
           <ui:param name="message" value="#{DobCompare.compareExtractedServiceException}"/>
           <ui:param name="exception" value="#{DobCompare.compareExtractedServiceStackTrace}"/>
           <ui:param name="uid" value="3"/>
         </ui:include>
      </dd>
      <p>
      <br/>
      </p>
          
    <!-- START WITH IDENTIFY SERVICE HERE -->    
    <dt><b>Identify</b></dt>
      <dd>
        <h:selectOneMenu value="#{DobCompare.identifyService}">
          <f:selectItem itemValue="" itemLabel="[none]" />
          <f:selectItems value="#{DobCompare.identifyServiceList}" />
          <a4j:support event="onchange" reRender="dobCompareForm" />
        </h:selectOneMenu>
      </dd>
      <h:panelGrid columns="2" columnClasses="halfContent">
    <rich:panel id="dobIdentify1">
      <f:facet name="header">
            <h:outputText value="#{DobCompare.dob1.leafname}"/>
      </f:facet>

      <dt>Identify Report:</dt>
      <dd>
        <h:outputText value="#{DobCompare.identify1ServiceReport}"/>
      </dd>
      <dt>Identify Result:</dt>
          <dd>
            <a4j:repeat value="#{DobCompare.identify1Types}" var="type">
             <i><h:outputText value="#{type}"/></i><br/>
            </a4j:repeat>
          </dd>
      <dd>
         <ui:include src="/WEB-INF/templates/fragments/show_error_modal.xhtml">
           <ui:param name="message" value="#{DobCompare.identifyServiceException}"/>
           <ui:param name="exception" value="#{DobCompare.identifyServiceStackTrace}"/>
           <ui:param name="uid" value="4"/>
         </ui:include>
      </dd>
    
    
    </rich:panel>
    
    <rich:panel id="dobIdentify2">
      <f:facet name="header">
            <h:outputText value="#{DobCompare.dob2.leafname}"/>
      </f:facet>

      <dt>Identify Report:</dt>
      <dd>
        <h:outputText value="#{DobCompare.identify2ServiceReport}"/>
      </dd>
      <dt>Identify Result:</dt>
          <dd>
            <a4j:repeat value="#{DobCompare.identify2Types}" var="type">
             <i><h:outputText value="#{type}"/></i><br/>
            </a4j:repeat>
          </dd>
  
    
    </rich:panel>
  </h:panelGrid>
    </rich:panel>
    </div>
    <!--
    <ui:include src="/WEB-INF/templates/fragments/do_inspection_returns.xhtml"/>
    -->
		<h:panelGroup rendered="#{ExperimentInspector.experimentId == null}">
        <h3 class="leftcol">Data Browser</h3>
                <div class="innertube">        
                    <p class="leftcol">
    <ui:include src="/WEB-INF/templates/fragments/do_inspection_returns.xhtml"/>
                    </p>
                </div>
		</h:panelGroup>
        
        <!--  FIXME Use this only in a special comparison page used in exp stage 5 -->
               
        <h:panelGroup rendered="#{ExperimentInspector.experimentId != null}">
        <h3 class="leftcol">Experiment Analysis</h3>
                <div class="innertube">        
                    <p class="leftcol">
                    <h:outputLink value="../exp/exp_stage5.faces">
                        <f:param name="eid" value="#{ExperimentInspector.experimentId}"/>
                        <h:outputText value="Return to the experiment analysis step."/>
                    </h:outputLink>
                </p>
                </div>
        </h:panelGroup>
        
        <p>&nbsp;</p>
        <p>&nbsp;</p>
        <p>&nbsp;</p>
        <p>&nbsp;</p>
        <p>&nbsp;</p>
    
        </div>
        </div>
        </div>
        
        
        <div id="leftcol">

		<h:panelGroup rendered="#{ExperimentInspector.experimentId == null}">
        <h3 class="leftcol">Data Browser</h3>
                <div class="innertube">        
                    <p class="leftcol">
    <ui:include src="/WEB-INF/templates/fragments/do_inspection_returns.xhtml"/>
                    </p>
                </div>
		</h:panelGroup>
        
        <!--  FIXME Use this only in a special comparison page used in exp stage 5 -->
               
        <h:panelGroup rendered="#{ExperimentInspector.experimentId != null}">
        <h3 class="leftcol">Experiment Analysis</h3>
                <div class="innertube">        
                    <p class="leftcol">
                    <h:outputLink value="../exp/exp_stage5.faces">
                        <f:param name="eid" value="#{ExperimentInspector.experimentId}"/>
                        <h:outputText value="Return to the experiment analysis step."/>
                    </h:outputLink>
                </p>
                </div>
        </h:panelGroup>
        <!--
        <h3 class="leftcol">Inspector</h3>
        <div class="innertube">        
        <p class="leftcol">

        </p>
        </div>
        -->
        </div>

 </a4j:form>  
    
  </ui:composition>
</body>
</html>
    
