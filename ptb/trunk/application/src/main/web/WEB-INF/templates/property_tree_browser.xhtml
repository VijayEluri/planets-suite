<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">
    
<body>
  <ui:composition>
    <style>
        .col1, .col2{
            width:50%;
            vertical-align:top;
        }
        .dropPanel {
        	border:1px solid gray;
        	padding:2px;
        }
    </style>

<div id="mainwrapper">
        <div id="maincol">
        	<div class="innertubemain">

    <a4j:form>    
    	<rich:dragIndicator id="indicator2"/>
    	
        <h:panelGrid columns="2" width="100%" columnClasses="col1,col2">
        	<rich:panel id="treepanel">
        	    <f:facet name="header">
                    <h:outputText value="all available Planets properties:" />
                </f:facet>
                
                <!-- select different view on the tree and possibly apply a full-text filter on the tree's nodes -->
                <rich:simpleTogglePanel switchType="client" label="apply settings: full-text filtering and different tree views" style="margin:2px;">            
    				<h:outputText value="filter properties: "/><h:inputText id="filterTree" value="#{simpleTreeDndBean.filterTreeString}" maxlength="500">
                    	<a4j:support event="onkeyup" reRender="propertytree" eventsQueue="foo"/>
            		</h:inputText>
            		
            		<!-- trigger collaps/expand of the tree -->
            		<a4j:commandButton id="collapsButton" value="collaps" action="#{simpleTreeDndBean.processCollapsExpandTree}" reRender="propertytree" eventsQueue="foo">
            			<f:param value="collaps" name="collapsexpand"/>
            		</a4j:commandButton>
            		<a4j:commandButton id="expandButton" value="expand" action="#{simpleTreeDndBean.processCollapsExpandTree}" reRender="propertytree" eventsQueue="foo">
            			<f:param value="expand" name="collapsexpand"/>
            		</a4j:commandButton>
            		<br/> 		
            		<!-- select between different views of the tree -->
					<h:outputText value="select tree view: "/><h:selectOneMenu value="#{simpleTreeDndBean.selectedViewItem}">
						<f:selectItems value="#{simpleTreeDndBean.availableViews}" />
					    <a4j:support event="onchange" reRender="propertytree" eventsQueue="foo"/>
					</h:selectOneMenu>
    			</rich:simpleTogglePanel>  
                
	            <rich:tree style="width:300px" nodeSelectListener="#{simpleTreeDndBean.processSelection}" 
	                reRender="infoPanel,selproppanel" ajaxSubmitSelection="true"  switchType="client"
	                id="propertytree" value="#{simpleTreeDndBean.treeNode}" var="item" 
	                dragIndicator="indicator2"  adviseNodeOpened="#{simpleTreeDndBean.adviseNodeOpened}"
	                treeNodeVar="treeNode" nodeFace="#{empty item.type == true ? 'node' : 'leaf'}">
	                <rich:treeNode type="node" icon="/graphics/iconFolder.gif" iconLeaf="/graphics/iconFolder.gif">
						<h:outputText value="#{item.name}" />
					</rich:treeNode>
					<rich:treeNode type="leaf" dragType="props" iconLeaf="/graphics/iconLeaf.gif"> 
		                 <rich:dndParam name="label" type="drag">property: #{item.name}</rich:dndParam>
		                 <a4j:support event="ondblclick" actionListener="#{simpleTreeDndBean.processPropertyDblClick}" reRender="selprops" eventsQueue="foo"/>
		                 <h:outputText value="#{item.name}"/>
		            </rich:treeNode>
	            </rich:tree>
            </rich:panel>
            <h:panelGrid columns="1" width="100%">
            	<!-- selected property info panel -->
	            <rich:simpleTogglePanel id="infoPanel" switchType="client" label="selected property information panel" style="margin:2px;">
		            <h:outputText value="selected node: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.nodeTitle}" /><br/>
		            <h:outputText value="uri: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.selTreeNode.data.URI}"/><br/>
		            <h:outputText value="type: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.selTreeNode.data.type}"/><br/>
		        	<h:outputText value="data type: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.selTreeNode.data.dataType}" /><br/>
		        	<h:outputText value="comment: " style="font-weight:bold;"/><h:outputText escape="false"  value="#{simpleTreeDndBean.selTreeNode.data.comment}"/><br/>
		        </rich:simpleTogglePanel>
		        
		        <!-- selected properties drop-off zone -->
	            <rich:panel id="selproppanel" style="droppanel">
	                <f:facet name="header">
	                    <h:outputText value="selected properties:" />
	                </f:facet>
	                <rich:dropSupport id="dropsupport" acceptedTypes="props" dropValue="selpropdrop"
	                    dropListener="#{simpleTreeDndBean.processDrop}" reRender="selprops">
	                </rich:dropSupport>
	
	                <h:dataTable id="selprops" columns="1" value="#{simpleTreeDndBean.selNodes}" var="propNodes">
	                    <h:column>
	                    	<a4j:commandLink action="#{simpleTreeDndBean.processDetailsForSelProp}" reRender="infoPanel">
	                    		<f:param value="#{propNodes.data.URI}" name="selPropID"/>
	                    		<h:outputText value="#{propNodes.data.name}"></h:outputText>
	                    	</a4j:commandLink> 
	                    	<a4j:commandLink action="#{simpleTreeDndBean.processRemoveSelProp}" reRender="infoPanel,selprops">
	                            <img src="${facesContext.externalContext.requestContextPath}/graphics/button_delete_query.gif" alt="remove" title="remove"/>
	                            <f:param value="#{propNodes.data.URI}" name="selPropID"/>
	                       </a4j:commandLink>
	                    </h:column>
	                </h:dataTable>
	            </rich:panel>
            
	            
	        </h:panelGrid>
        </h:panelGrid>

    </a4j:form>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
        <p>&#160;</p>
    </div>
    </div>
    </div>
    
    <div id="leftcol">
		
		<h3 class="leftcol">Planets Ontology Browser</h3>
        <div class="innertube">        
        <p class="leftcol">Explore all properties the Testbed can measure for you</p>        
		<p class="leftcol">Multiple tree views of the ontology are available</p>     
		<p class="leftcol">Searching is facilitated by a full-text search</p>           
        </div>
        
        <h3 class="leftcol">Information</h3>
        <div class="innertube">
        <form method="get" action="restrict/">
        <p class="leftcol">For futher information regarding properties or the process on adding 
        them to the Testbed please contact<br/>The Planets Properties Working Group (DOPWG)</p>         
        </form>        
        </div>
		
   </div>
  </ui:composition>
</body>
</html>