<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich">
    
<body>
  <ui:composition>
    <style>
        .col1, .col2{
            width:50%;
            vertical-align:top;
        }
        .dropPanel {
        	border:1px solid gray;
        	padding:2px;
        }
    </style>

    <a4j:form>    
    	<rich:dragIndicator id="indicator2"/>
    	
        <h:panelGrid columns="2" width="100%" columnClasses="col1,col2">
        	<rich:panel id="treepanel">
        	    <f:facet name="header">
                    <h:outputText value="all available Planets properties:" />
                </f:facet>
                
                <!-- select different view on the tree and possibly apply a full-text filter on the tree's nodes -->
                <rich:simpleTogglePanel switchType="client" label="apply settings: full-text filtering and different tree views" style="margin:2px;">            
    				<a4j:region id="settings">
	    				<h:outputText value="filter properties: "/><h:inputText id="filterTree" value="#{simpleTreeDndBean.filterTreeString}" maxlength="500">
	                    	<a4j:support requestDelay="1000" event="onkeyup" reRender="propertytree" eventsQueue="foo" ignoreDupResponses="true"/>
	            		</h:inputText>
			
	            		<!-- trigger collaps/expand of the tree -->
	            		<a4j:commandButton id="collapsButton" value="collapse" action="#{simpleTreeDndBean.processCollapsExpandTree}" reRender="propertytree" eventsQueue="foo">
	            			<f:param value="collaps" name="collapsexpand"/>
	            		</a4j:commandButton>
	            		<a4j:commandButton id="expandButton" value="expand" action="#{simpleTreeDndBean.processCollapsExpandTree}" reRender="propertytree" eventsQueue="foo">
	            			<f:param value="expand" name="collapsexpand"/>
	            		</a4j:commandButton>
	            		<a4j:status for="settings">
	                		<f:facet name="start">
	                    		<h:graphicImage  value="/graphics/spinner.gif"/>
	                		</f:facet>
	            			</a4j:status>
            			<br/> 		
	            		<!-- select between different views of the tree -->
						<h:outputText value="select tree view: "/><h:selectOneMenu value="#{simpleTreeDndBean.selectedViewItem}">
							<f:selectItems value="#{simpleTreeDndBean.availableViews}" />
						    <a4j:support event="onchange" reRender="propertytree" eventsQueue="foo"/>
						</h:selectOneMenu>
					</a4j:region>

    			</rich:simpleTogglePanel>  
  
	            <rich:tree style="width:300px" nodeSelectListener="#{simpleTreeDndBean.processSelection}" 
	                reRender="infoPanel,selproppanel" ajaxSubmitSelection="true" ignoreDupResponses="true" eventsQueue="foo"
	                switchType="client" id="propertytree" value="#{simpleTreeDndBean.treeNode}" var="item" 
	                dragIndicator="indicator2"  adviseNodeOpened="#{simpleTreeDndBean.adviseNodeOpened}"
	                treeNodeVar="treeNode" nodeFace="#{empty item.type == true ? 'node' : 'leaf'}">
	                <rich:treeNode type="node" icon="/graphics/iconFolder.gif" iconLeaf="/graphics/iconFolder.gif">
						<h:outputText value="#{item.name}" />
					</rich:treeNode>
					<rich:treeNode type="leaf" dragType="props" iconLeaf="/graphics/iconLeaf.gif"> 
		                 <rich:dndParam name="label" type="drag">property: #{item.name}</rich:dndParam>
		                 <a4j:support event="ondblclick" actionListener="#{simpleTreeDndBean.processPropertyDblClick}" reRender="selprops" eventsQueue="foo" rendered="#{(not empty expApproved) ? (!expApproved) : true}"/>
		                 <h:outputText value="#{item.name}"/>
		            </rich:treeNode>
	            </rich:tree>
            </rich:panel>
            <h:panelGrid columns="1" width="100%">
            	<!-- selected property info panel -->
	            <rich:simpleTogglePanel id="infoPanel" switchType="client" label="selected property information panel" style="margin:2px;">
		            <h:outputText value="selected node: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.nodeTitle}" /><br/>
		            <h:outputText value="uri: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.selTreeNode.data.URI}"/><br/>
		            <h:outputText value="type: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.selTreeNode.data.type}"/><br/>
		        	<h:outputText value="data type: " style="font-weight:bold;"/><h:outputText escape="false" value="#{simpleTreeDndBean.selTreeNode.data.dataType}" /><br/>
		        	<h:outputText value="comment: " style="font-weight:bold;"/><h:outputText escape="false"  value="#{simpleTreeDndBean.selTreeNode.data.comment}"/><br/>
		        </rich:simpleTogglePanel>
		        	     
		        	     #{(! empty Standalone)}
		        	     #{(Standalone=='true')}
		        	     #{(Standalone==true)}
		        	      #{Standalone}
		        <c:if test="#{(! empty Standalone) and (Standalone=='false')}">
		        	<h:outputText value="Test ok"/>
		        </c:if>
		        
		        <!-- selected properties drop-off zone -->
	            <rich:panel id="selproppanel" style="droppanel">
	                <f:facet name="header">
	                    <a4j:outputPanel ajaxRendered="true"><h:outputText value="clipboard" /> <a4j:commandButton id="clearclipboardprops" value="clear" action="#{simpleTreeDndBean.removeAllSelectedProps}" reRender="selproppanel,clearclipboardprops" eventsQueue="foo" disabled="#{(simpleTreeDndBean.selNodesSize lt 1) or (expApproved)}"/></a4j:outputPanel>
	                </f:facet>
	                <rich:dropSupport id="dropsupport" acceptedTypes="#{expApproved ? 'none' : 'props'}" dropValue="selpropdrop"
	                    dropListener="#{simpleTreeDndBean.processDrop}" reRender="selprops">
	                </rich:dropSupport>
	
	                <h:dataTable id="selprops" columns="1" value="#{simpleTreeDndBean.selNodes}" var="propNodes">
	                    <h:column>
	                    	<a4j:commandLink action="#{simpleTreeDndBean.processDetailsForSelProp}" reRender="infoPanel">
	                    		<f:param value="#{propNodes.data.URI}" name="selPropID"/>
	                    		<h:outputText value="#{propNodes.data.name}"></h:outputText>
	                    	</a4j:commandLink> 
	                    	<a4j:commandLink action="#{simpleTreeDndBean.processRemoveSelProp}" reRender="infoPanel,selprops" rendered="#{!expApproved}">
	                            <img src="${facesContext.externalContext.requestContextPath}/graphics/button_delete_query.gif" alt="remove" title="remove"/>
	                            <f:param value="#{propNodes.data.URI}" name="selPropID"/>
	                       </a4j:commandLink>
	                    </h:column>
	                </h:dataTable>
	            </rich:panel>
            
	            
	        </h:panelGrid>
        </h:panelGrid>

    </a4j:form>

  </ui:composition>
</body>
</html>